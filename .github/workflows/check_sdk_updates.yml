name: Check SDK Updates

on:
  schedule:
    - cron: '0 * * * *' # æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
  workflow_dispatch: # æ”¯æŒæ‰‹åŠ¨è§¦å‘

jobs:
  check-release:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    strategy:
      fail-fast: false
      matrix:
        repo:
          - "facebook/facebook-ios-sdk"            # Facebook SDK
          - "adjust/ios_sdk"                       # Adjust SDK
          - "firebase/firebase-ios-sdk"            # Firebase SDK
          - "adjust/adjust_signature_sdk"          # Adjust Signature SDK

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install dependencies
        run: |
          pip install requests
      
      - name: Verify Python and requests
        run: |
          python --version
          pip show requests

      - name: Verify check_release.py exists
        run: |
          ls -la
          if [ -f "check_release.py" ]; then
            echo "âœ… check_release.py found in root directory"
          else
            echo "âŒ check_release.py not found in root directory"
            exit 1
          fi

      - name: Check for new release
        id: check-release
        env:
          REPO: ${{ matrix.repo }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_PAT }}
        run: |
          echo "å½“å‰å·¥ä½œç›®å½•: $(pwd)"
          echo "ç¯å¢ƒå˜é‡ REPO: $REPO"
          echo "ç¯å¢ƒå˜é‡ GITHUB_TOKEN: ${GITHUB_TOKEN:0:5}..."  # åªæ˜¾ç¤ºå‰5ä¸ªå­—ç¬¦ï¼Œé¿å…æ³„éœ²
          python check_release.py

      - name: Send GitHub Notification
        if: env.NEW_VERSION != ''
        run: |
          echo "ğŸš€ æ–°ç‰ˆæœ¬: ${{ env.NEW_VERSION }}"
          echo "ğŸ”— é“¾æ¥: ${{ env.RELEASE_URL }}"
          echo "ğŸ“¦ SDK: ${{ env.SDK }}"

      - name: Send Email Notification
        if: env.NEW
